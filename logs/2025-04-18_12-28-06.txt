Defaulting to user installation because normal site-packages is not writeable
ERROR: Invalid requirement: '# Core dependencies for the Discord bot and async operations': Expected package name at the start of dependency specifier
    # Core dependencies for the Discord bot and async operations
    ^
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: discord.py==2.3.2 in ./.local/lib/python3.12/site-packages (2.3.2)
Requirement already satisfied: aiohttp<4,>=3.7.4 in ./.local/lib/python3.12/site-packages (from discord.py==2.3.2) (3.9.5)
Requirement already satisfied: aiosignal>=1.1.2 in ./.local/lib/python3.12/site-packages (from aiohttp<4,>=3.7.4->discord.py==2.3.2) (1.3.2)
Requirement already satisfied: attrs>=17.3.0 in ./.local/lib/python3.12/site-packages (from aiohttp<4,>=3.7.4->discord.py==2.3.2) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in ./.local/lib/python3.12/site-packages (from aiohttp<4,>=3.7.4->discord.py==2.3.2) (1.5.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./.local/lib/python3.12/site-packages (from aiohttp<4,>=3.7.4->discord.py==2.3.2) (6.2.0)
Requirement already satisfied: yarl<2.0,>=1.0 in ./.local/lib/python3.12/site-packages (from aiohttp<4,>=3.7.4->discord.py==2.3.2) (1.18.3)
Requirement already satisfied: idna>=2.0 in ./.local/lib/python3.12/site-packages (from yarl<2.0,>=1.0->aiohttp<4,>=3.7.4->discord.py==2.3.2) (3.10)
Requirement already satisfied: propcache>=0.2.0 in ./.local/lib/python3.12/site-packages (from yarl<2.0,>=1.0->aiohttp<4,>=3.7.4->discord.py==2.3.2) (0.3.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: aiohttp==3.9.5 in ./.local/lib/python3.12/site-packages (3.9.5)
Requirement already satisfied: aiosignal>=1.1.2 in ./.local/lib/python3.12/site-packages (from aiohttp==3.9.5) (1.3.2)
Requirement already satisfied: attrs>=17.3.0 in ./.local/lib/python3.12/site-packages (from aiohttp==3.9.5) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in ./.local/lib/python3.12/site-packages (from aiohttp==3.9.5) (1.5.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./.local/lib/python3.12/site-packages (from aiohttp==3.9.5) (6.2.0)
Requirement already satisfied: yarl<2.0,>=1.0 in ./.local/lib/python3.12/site-packages (from aiohttp==3.9.5) (1.18.3)
Requirement already satisfied: idna>=2.0 in ./.local/lib/python3.12/site-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5) (3.10)
Requirement already satisfied: propcache>=0.2.0 in ./.local/lib/python3.12/site-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5) (0.3.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: aiomysql==0.2.0 in ./.local/lib/python3.12/site-packages (0.2.0)
Requirement already satisfied: PyMySQL>=1.0 in ./.local/lib/python3.12/site-packages (from aiomysql==0.2.0) (1.1.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: redis==5.0.4 in ./.local/lib/python3.12/site-packages (5.0.4)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: cryptography==42.0.5 in ./.local/lib/python3.12/site-packages (42.0.5)
Requirement already satisfied: cffi>=1.12 in ./.local/lib/python3.12/site-packages (from cryptography==42.0.5) (1.17.1)
Requirement already satisfied: pycparser in ./.local/lib/python3.12/site-packages (from cffi>=1.12->cryptography==42.0.5) (2.22)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: aiohttp-session==2.12.0 in ./.local/lib/python3.12/site-packages (2.12.0)
Requirement already satisfied: aiohttp>=3.8 in ./.local/lib/python3.12/site-packages (from aiohttp-session==2.12.0) (3.9.5)
Requirement already satisfied: aiosignal>=1.1.2 in ./.local/lib/python3.12/site-packages (from aiohttp>=3.8->aiohttp-session==2.12.0) (1.3.2)
Requirement already satisfied: attrs>=17.3.0 in ./.local/lib/python3.12/site-packages (from aiohttp>=3.8->aiohttp-session==2.12.0) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in ./.local/lib/python3.12/site-packages (from aiohttp>=3.8->aiohttp-session==2.12.0) (1.5.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./.local/lib/python3.12/site-packages (from aiohttp>=3.8->aiohttp-session==2.12.0) (6.2.0)
Requirement already satisfied: yarl<2.0,>=1.0 in ./.local/lib/python3.12/site-packages (from aiohttp>=3.8->aiohttp-session==2.12.0) (1.18.3)
Requirement already satisfied: idna>=2.0 in ./.local/lib/python3.12/site-packages (from yarl<2.0,>=1.0->aiohttp>=3.8->aiohttp-session==2.12.0) (3.10)
Requirement already satisfied: propcache>=0.2.0 in ./.local/lib/python3.12/site-packages (from yarl<2.0,>=1.0->aiohttp>=3.8->aiohttp-session==2.12.0) (0.3.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: jinja2==3.1.2 in ./.local/lib/python3.12/site-packages (3.1.2)
Requirement already satisfied: MarkupSafe>=2.0 in ./.local/lib/python3.12/site-packages (from jinja2==3.1.2) (3.0.2)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: python-dotenv==1.0.1 in ./.local/lib/python3.12/site-packages (1.0.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: Pillow==10.3.0 in ./.local/lib/python3.12/site-packages (10.3.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: PyTZ==2024.1 in ./.local/lib/python3.12/site-packages (2024.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: typing_extensions==4.11.0 in ./.local/lib/python3.12/site-packages (4.11.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: jsonpickle==3.0.4 in ./.local/lib/python3.12/site-packages (3.0.4)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: regex==2024.5.15 in ./.local/lib/python3.12/site-packages (2024.5.15)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pandas==2.2.2 in ./.local/lib/python3.12/site-packages (2.2.2)
Requirement already satisfied: numpy>=1.26.0 in ./.local/lib/python3.12/site-packages (from pandas==2.2.2) (2.2.4)
Requirement already satisfied: python-dateutil>=2.8.2 in ./.local/lib/python3.12/site-packages (from pandas==2.2.2) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in ./.local/lib/python3.12/site-packages (from pandas==2.2.2) (2024.1)
Requirement already satisfied: tzdata>=2022.7 in ./.local/lib/python3.12/site-packages (from pandas==2.2.2) (2025.1)
Requirement already satisfied: six>=1.5 in ./.local/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas==2.2.2) (1.17.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: apscheduler==3.10.4 in ./.local/lib/python3.12/site-packages (3.10.4)
Requirement already satisfied: six>=1.4.0 in ./.local/lib/python3.12/site-packages (from apscheduler==3.10.4) (1.17.0)
Requirement already satisfied: pytz in ./.local/lib/python3.12/site-packages (from apscheduler==3.10.4) (2024.1)
Requirement already satisfied: tzlocal!=3.*,>=2.0 in ./.local/lib/python3.12/site-packages (from apscheduler==3.10.4) (5.3.1)
2025-04-18 12:28:24,924 - __main__ - INFO - Starting main execution block (__name__ == '__main__')
2025-04-18 12:28:24,924 - __main__ - INFO - --- Entered main() ---
2025-04-18 12:28:24,924 - __main__ - INFO - Initializing BettingBot class...
2025-04-18 12:28:24,924 - bot.core - INFO - --- BettingBot __init__ START ---
2025-04-18 12:28:24,925 - bot.core - INFO - Initializing DB Manager instance...
2025-04-18 12:28:24,925 - bot.core - INFO - Initializing Cache Manager instance...
2025-04-18 12:28:24,925 - bot.core - INFO - Initializing Command Tree...
2025-04-18 12:28:24,925 - bot.core - INFO - Initializing Game Service...
2025-04-18 12:28:24,925 - bot.services.game_service - INFO - GameService initialized.
2025-04-18 12:28:24,925 - bot.core - INFO - Initializing Voice Service...
2025-04-18 12:28:24,925 - bot.core - INFO - Initializing Bet Service...
2025-04-18 12:28:24,925 - bot.services.bet_service - INFO - BetService initialized.
2025-04-18 12:28:24,925 - bot.core - INFO - Initializing Web App variable...
2025-04-18 12:28:24,925 - bot.core - INFO - --- BettingBot __init__ END ---
2025-04-18 12:28:24,925 - __main__ - INFO - BettingBot instance created.
2025-04-18 12:28:24,925 - __main__ - INFO - Attempting to start bot...
2025-04-18 12:28:24,925 - discord.client - INFO - logging in using static token
2025-04-18 12:28:25,222 - bot.core - INFO - --- Running setup_hook ---
2025-04-18 12:28:25,223 - bot.core - INFO - STEP: Connecting to Database...
2025-04-18 12:28:25,223 - bot.data.db_manager - INFO - Attempting to connect to database 'customer_990306_Server_database' at na05-sql.pebblehost.com:3306
2025-04-18 12:28:25,350 - bot.data.db_manager - INFO - Database connection pool initialized successfully
2025-04-18 12:28:25,352 - bot.data.db_manager - INFO - All expected tables (bets, cappers, server_settings, subscribers, subscriptions, unit_records, users, user_images, voice_bet_updates) and server_settings.commands_registered column found in database 'customer_990306_Server_database'.
2025-04-18 12:28:25,352 - bot.core - INFO - STEP COMPLETE: Database connected.
2025-04-18 12:28:25,352 - bot.core - INFO - STEP: Connecting to Cache...
2025-04-18 12:28:25,352 - bot.data.cache_manager - INFO - Attempting to connect to Redis at redis-14768.c246.us-east-1-4.ec2.redns.redis-cloud.com:14768
2025-04-18 12:28:25,430 - bot.data.cache_manager - INFO - Redis connection initialized successfully
2025-04-18 12:28:25,430 - bot.core - INFO - STEP COMPLETE: Cache connected.
2025-04-18 12:28:25,430 - bot.core - INFO - STEP: Starting Game Service...
2025-04-18 12:28:25,430 - api.sports_api - INFO - Sports API client session started
2025-04-18 12:28:25,430 - bot.services.game_service - INFO - Fetching initial game data for pending bets...
2025-04-18 12:28:25,462 - bot.services.game_service - INFO - Initial game data fetching complete.
2025-04-18 12:28:25,462 - bot.services.game_service - INFO - Game service polling started.
2025-04-18 12:28:25,462 - bot.core - INFO - STEP: Starting Voice Service...
2025-04-18 12:28:25,462 - bot.services.voice_service - INFO - Voice service update loop started.
2025-04-18 12:28:25,462 - bot.services.voice_service - INFO - Monthly total update loop started.
2025-04-18 12:28:25,462 - bot.services.voice_service - INFO - Voice service started.
2025-04-18 12:28:25,462 - bot.core - INFO - STEP: Starting Bet Service (scheduler)...
2025-04-18 12:28:25,462 - bot.services.bet_service - INFO - Bet service starting (scheduler only).
2025-04-18 12:28:25,462 - bot.services.bet_service - INFO - Setting up APScheduler jobs for tallying.
2025-04-18 12:28:25,482 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-04-18 12:28:25,482 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-04-18 12:28:25,483 - apscheduler.scheduler - INFO - Added job "BetService.run_monthly_tally" to job store "default"
2025-04-18 12:28:25,483 - apscheduler.scheduler - INFO - Added job "BetService.run_yearly_tally" to job store "default"
2025-04-18 12:28:25,483 - apscheduler.scheduler - INFO - Scheduler started
2025-04-18 12:28:25,483 - bot.services.bet_service - INFO - APScheduler started successfully with tally jobs.
2025-04-18 12:28:25,483 - bot.services.bet_service - INFO - Bet service scheduler started.
2025-04-18 12:28:25,483 - bot.core - INFO - STEP COMPLETE: Bet Service scheduler started.
2025-04-18 12:28:25,483 - bot.core - INFO - STEP: Running startup reconciliation checks...
2025-04-18 12:28:25,483 - bot.tasks.startup_checks - INFO - Running startup checks (Logic Update 2025-04-15 v3 - FINAL)...
2025-04-18 12:28:25,483 - bot.tasks.startup_checks - INFO - Checking for pending bets (0/0) missing unit records (will insert units=0, total=0)...
2025-04-18 12:28:25,484 - bot.tasks.startup_checks - INFO - No pending bets (0/0) found missing unit records.
2025-04-18 12:28:25,485 - bot.tasks.startup_checks - INFO - Loaded 0 pending bets into memory. Created 0 missing placeholder unit records. Resolved 0 bets by reaction. Skipped 0 bets.
2025-04-18 12:28:25,485 - bot.tasks.startup_checks - INFO - Reconciling 'units' column for ALL resolved bets (Create if Missing, Update if Exists AND units=0)...
2025-04-18 12:28:25,485 - bot.tasks.startup_checks - INFO - Found 19 resolved bets to check/reconcile.
2025-04-18 12:28:25,495 - bot.tasks.startup_checks - INFO - Checked resolved unit records. Updated 0 entries where units were 0. Created 0 missing records for resolved bets.
2025-04-18 12:28:25,495 - bot.tasks.startup_checks - INFO - Startup checks completed.
2025-04-18 12:28:25,495 - bot.core - INFO - STEP COMPLETE: Startup reconciliation checks finished.
2025-04-18 12:28:25,495 - bot.core - INFO - STEP: Setting up web server...
2025-04-18 12:28:25,496 - web.server - WARNING - Static directory not found at: /home/container/bot/static_site. Creating.
2025-04-18 12:28:25,497 - bot.core - CRITICAL - CRITICAL UNEXPECTED ERROR during setup_hook: No directory exists at '/home/container/bot/static_site/static'
Traceback (most recent call last):
  File "/home/container/.local/lib/python3.12/site-packages/aiohttp/web_urldispatcher.py", line 565, in __init__
    raise ValueError("Not a directory")
ValueError: Not a directory

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/container/bot/core.py", line 224, in setup_hook
    self.web_app = await setup_server(self)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/container/bot/web/server.py", line 66, in setup_server
    app.router.add_static("/static", static_path / "static", name="static", show_index=True)
  File "/home/container/.local/lib/python3.12/site-packages/aiohttp/web_urldispatcher.py", line 1138, in add_static
    resource = StaticResource(
               ^^^^^^^^^^^^^^^
  File "/home/container/.local/lib/python3.12/site-packages/aiohttp/web_urldispatcher.py", line 567, in __init__
    raise ValueError(f"No directory exists at '{directory}'") from error
ValueError: No directory exists at '/home/container/bot/static_site/static'
2025-04-18 12:28:25,498 - bot.core - INFO - --- Initiating bot shutdown sequence ---
2025-04-18 12:28:25,498 - bot.core - INFO - STEP: Stopping web server...
2025-04-18 12:28:25,498 - bot.core - INFO - STEP: Stopping Bet Service...
2025-04-18 12:28:25,498 - bot.services.bet_service - INFO - Bet service stopping.
2025-04-18 12:28:25,498 - bot.services.bet_service - INFO - APScheduler shut down.
2025-04-18 12:28:25,498 - bot.services.bet_service - INFO - Bet service stopped.
2025-04-18 12:28:25,498 - bot.core - INFO - STEP: Stopping Voice Service...
2025-04-18 12:28:25,498 - bot.services.voice_service - INFO - Voice service update task cancelled.
2025-04-18 12:28:25,498 - bot.services.voice_service - INFO - Monthly total update task cancelled.
2025-04-18 12:28:25,498 - bot.services.voice_service - INFO - Voice service stopped.
2025-04-18 12:28:25,498 - bot.core - INFO - STEP: Stopping Game Service...
2025-04-18 12:28:25,498 - bot.services.game_service - INFO - Stopping Game Service...
2025-04-18 12:28:25,498 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-04-18 12:28:25,498 - bot.services.game_service - INFO - Game service polling task successfully cancelled.
2025-04-18 12:28:25,499 - api.sports_api - INFO - Sports API client session closed
2025-04-18 12:28:25,499 - bot.services.game_service - INFO - Game service stopped.
2025-04-18 12:28:25,499 - bot.core - INFO - STEP: Closing Cache connection...
2025-04-18 12:28:25,499 - bot.data.cache_manager - INFO - Redis connection closed
2025-04-18 12:28:25,499 - bot.core - INFO - STEP: Closing Database connection...
2025-04-18 12:28:25,499 - bot.data.db_manager - INFO - Database connection pool closed
2025-04-18 12:28:25,499 - bot.core - INFO - STEP: Closing Discord client connection...
2025-04-18 12:28:25,499 - bot.core - INFO - STEP COMPLETE: Discord client connection closed.
2025-04-18 12:28:25,499 - bot.core - INFO - --- Bot shutdown sequence complete ---
2025-04-18 12:28:25,499 - __main__ - INFO - Initiating bot close sequence...
2025-04-18 12:28:25,499 - __main__ - INFO - Bot shutdown process complete.
2025-04-18 12:28:25,500 - __main__ - INFO - Exiting main script.
