2025-04-06 23:25:17 [INFO] root: Logging configured successfully
2025-04-06 23:25:17 [DEBUG] asyncio: Using selector: EpollSelector
2025-04-06 23:25:17 [INFO] root: Logging configured successfully
2025-04-06 23:25:17 [INFO] __main__: Starting bot initialization
2025-04-06 23:25:17 [INFO] bot.data.db_manager: Attempting to connect to database s353073_bet_tracking_db at us.mysql.db.bot-hosting.net:3306
2025-04-06 23:25:17 [INFO] bot.data.db_manager: Database connection pool initialized successfully
2025-04-06 23:25:17 [DEBUG] bot.data.db_manager: Executing setup query 1...
2025-04-06 23:25:17 [DEBUG] bot.data.db_manager: Executing setup query 2...
2025-04-06 23:25:17 [DEBUG] bot.data.db_manager: Executing setup query 3...
2025-04-06 23:25:18 [DEBUG] bot.data.db_manager: Executing setup query 4...
2025-04-06 23:25:18 [INFO] bot.data.db_manager: Database tables checked/created successfully
2025-04-06 23:25:18 [INFO] __main__: Database connected successfully
2025-04-06 23:25:18 [DEBUG] __main__: Starting bot with Discord token (first 5 chars: MTM0M...)
2025-04-06 23:25:18 [INFO] bot.data.cache_manager: Attempting to connect to Redis at redis-14768.c246.us-east-1-4.ec2.redns.redis-cloud.com:14768
2025-04-06 23:25:18 [INFO] bot.data.cache_manager: Redis connection initialized successfully
2025-04-06 23:25:18 [INFO] api.sports_api: Sports API client session started
2025-04-06 23:25:18 [INFO] bot.services.game_service: Fetching initial game data for pending bets...
2025-04-06 23:25:18 [WARNING] data.db_manager: Database pool closed or not initialized. Attempting to reconnect.
2025-04-06 23:25:18 [INFO] data.db_manager: Attempting to connect to database s353073_bet_tracking_db at us.mysql.db.bot-hosting.net:3306
2025-04-06 23:25:18 [INFO] data.db_manager: Database connection pool initialized successfully
2025-04-06 23:25:18 [DEBUG] data.db_manager: Executing setup query 1...
2025-04-06 23:25:18 [DEBUG] data.db_manager: Executing setup query 2...
2025-04-06 23:25:18 [DEBUG] data.db_manager: Executing setup query 3...
2025-04-06 23:25:19 [DEBUG] data.db_manager: Executing setup query 4...
2025-04-06 23:25:19 [INFO] data.db_manager: Database tables checked/created successfully
2025-04-06 23:25:19 [DEBUG] data.db_manager: Fetching DB query: 
                SELECT DISTINCT event_id, league, team, opponent, game_start
                FROM bets
                WHERE event_id IS NOT NULL
                  AND bet_won IS NULL
                  AND bet_loss IS NULL
             with params: None
2025-04-06 23:25:19 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:25:19 [DEBUG] bot.services.game_service: Found 0 unique pending bet events to initialize.
2025-04-06 23:25:19 [WARNING] data.cache_manager: Redis client not initialized. Attempting connection.
2025-04-06 23:25:19 [INFO] data.cache_manager: Attempting to connect to Redis at redis-14768.c246.us-east-1-4.ec2.redns.redis-cloud.com:14768
2025-04-06 23:25:19 [INFO] data.cache_manager: Redis connection initialized successfully
2025-04-06 23:25:19 [DEBUG] data.cache_manager: Cache set: live_games (TTL: 600)
2025-04-06 23:25:19 [DEBUG] bot.services.game_service: Updated live games cache with 0 games.
2025-04-06 23:25:19 [INFO] bot.services.game_service: Initial game data fetching complete.
2025-04-06 23:25:19 [INFO] bot.services.game_service: Game service polling started.
2025-04-06 23:25:19 [INFO] bot.services.voice_service: Voice service update loop started.
2025-04-06 23:25:19 [INFO] web.server: Web application setup complete.
2025-04-06 23:25:19 [INFO] bot.core: Loading application commands...
2025-04-06 23:25:19 [INFO] bot.core: Loaded command: add_capper
2025-04-06 23:25:19 [INFO] bot.core: Loaded command: admin
2025-04-06 23:25:19 [INFO] bot.core: Loaded command: cancel_bet
2025-04-06 23:25:19 [INFO] bot.core: Loaded command: help
2025-04-06 23:25:19 [DEBUG] matplotlib: matplotlib data path: /home/container/.local/lib/python3.12/site-packages/matplotlib/mpl-data
2025-04-06 23:25:19 [DEBUG] matplotlib: CONFIGDIR=/home/container/.config/matplotlib
2025-04-06 23:25:19 [DEBUG] matplotlib: interactive is False
2025-04-06 23:25:19 [DEBUG] matplotlib: platform is linux
2025-04-06 23:25:19 [DEBUG] matplotlib: CACHEDIR=/home/container/.cache/matplotlib
2025-04-06 23:25:19 [DEBUG] matplotlib.font_manager: Using fontManager instance from /home/container/.cache/matplotlib/fontlist-v390.json
2025-04-06 23:25:20 [INFO] bot.core: Loaded command: leaderboard
2025-04-06 23:25:20 [INFO] bot.core: Loaded command: load_url
2025-04-06 23:25:20 [INFO] bot.core: Loaded command: profile
2025-04-06 23:25:20 [INFO] bot.core: Loaded command: setid
2025-04-06 23:25:20 [INFO] bot.core: Loaded command: show_cappers
2025-04-06 23:25:20 [INFO] bot.core: Loaded command: stats
2025-04-06 23:25:20 [INFO] bot.core: Loaded command: subscription
2025-04-06 23:25:20 [INFO] bot.core: Assuming 'bet' command is handled by BetService internally.
2025-04-06 23:25:20 [INFO] bot.core: Application commands loaded.
2025-04-06 23:25:20 [INFO] web.server: Web server started at http://0.0.0.0:20900/
2025-04-06 23:25:20 [INFO] bot.core: Commands synced to test guild ID: 1328126227013439601
2025-04-06 23:25:22 [INFO] bot.services.voice_service: Voice service entering update loop.
2025-04-06 23:25:22 [DEBUG] bot.services.voice_service: Voice service sleeping for 278.00 seconds until next 5-min mark.
2025-04-06 23:25:22 [INFO] bot.core: Logged in as Bet Embed Generator (ID: 1341993312915034153)
2025-04-06 23:25:22 [INFO] bot.core: Discord.py version: 2.3.2
2025-04-06 23:25:22 [INFO] bot.core: Bot is ready and online.
2025-04-06 23:25:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-06 23:25:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-06 23:25:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:25:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-06 23:25:26 [DEBUG] bot.services.bet_service: /bet invoked in channel ID: 1357136356022816798 by user 761388542965448767 in guild 1328126227013439601
2025-04-06 23:25:26 [DEBUG] bot.data.db_manager: Fetching one DB query: 
                    SELECT command_channel_1, command_channel_2, embed_channel_1, embed_channel_2, authorized_role
                    FROM server_settings WHERE guild_id = %s
                 with params: (1328126227013439601,)
2025-04-06 23:25:26 [DEBUG] bot.data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:25:26 [WARNING] bot.services.bet_service: Could not convert DB value to int for guild 1328126227013439601: 'Cappers'
2025-04-06 23:25:26 [DEBUG] bot.services.bet_service: Channel Check: Current=1357136356022816798 (type: <class 'int'>), Allowed=[1344085704984100934, 1357136356022816798] (types: [<class 'int'>, <class 'int'>])
2025-04-06 23:25:26 [DEBUG] bot.services.bet_service: No authorized role configured for guild 1328126227013439601, allowing /bet command.
2025-04-06 23:25:26 [INFO] bot.services.bet_service: /bet initiated by 761388542965448767 in allowed channel 1357136356022816798 for guild 1328126227013439601.
2025-04-06 23:25:26 [DEBUG] utils.serial_utils: Generated bet serial: 202504070625899
2025-04-06 23:25:26 [DEBUG] bot.services.bet_service: BetWorkflowView initialized (Serial: 202504070625899) Embed Channels: 1328126391073505422, 1357136356022816798
2025-04-06 23:25:26 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070625899. State: League=None, Type=None, Path=None, Preview=False
2025-04-06 23:25:26 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-06 23:25:29 [INFO] bot.services.bet_service: League selected: nba by 761388542965448767 (Serial: 202504070625899)
2025-04-06 23:25:29 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070625899. State: League=nba, Type=None, Path=None, Preview=False
2025-04-06 23:25:29 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-06 23:25:31 [INFO] bot.services.bet_service: Bet Type selected: Straight by 761388542965448767 (Serial: 202504070625899)
2025-04-06 23:25:31 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070625899. State: League=nba, Type=Straight, Path=None, Preview=False
2025-04-06 23:25:31 [DEBUG] bot.services.bet_service: View updated with 3 components.
2025-04-06 23:25:33 [INFO] bot.services.bet_service: Path chosen: Game Line by 761388542965448767 (Serial: 202504070625899)
2025-04-06 23:25:50 [INFO] bot.services.bet_service: Path chosen: Game Line by 761388542965448767 (Serial: 202504070625899)
2025-04-06 23:26:13 [INFO] bot.services.bet_service: Game Line Modal submitted by 761388542965448767 (Serial: 202504070625899): {'team': 'lakers', 'opponent': 'celtics', 'line': 'ml', 'odds': '-110', 'path': 'Game Line'}
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Generating preview for bet serial 202504070625899
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for team: lakers
2025-04-06 23:26:13 [DEBUG] bot.data.league.league_team_handler: Normalized team name: lakers -> lakers for league nba
2025-04-06 23:26:13 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:lakers
2025-04-06 23:26:13 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Result from get_team_logo_url_from_csv (team): None
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Final team_logo_url after fallback check: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for opponent: celtics
2025-04-06 23:26:13 [DEBUG] bot.data.league.league_team_handler: Normalized team name: celtics -> celtics for league nba
2025-04-06 23:26:13 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:celtics
2025-04-06 23:26:13 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Result from get_team_logo_url_from_csv (opponent): None
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Final opponent_logo_url after fallback check: None
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Attempting to set thumbnail URL: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Thumbnail set successfully.
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070625899. State: League=nba, Type=Straight, Path=Game Line, Preview=True
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Populating ChannelSelect for guild 1328126227013439601 with IDs: [1328126391073505422, 1357136356022816798]
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Added channel option: #ðŸ“–-play-book (1328126391073505422)
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Added channel option: #team-chat (1357136356022816798)
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: View updated with 5 components.
2025-04-06 23:26:13 [DEBUG] bot.services.bet_service: Preview shown/updated for bet serial 202504070625899
2025-04-06 23:26:19 [INFO] bot.services.bet_service: Bet setup cancelled by 761388542965448767 for bet serial 202504070625899
2025-04-06 23:26:24 [DEBUG] bot.services.bet_service: /bet invoked in channel ID: 1357136356022816798 by user 761388542965448767 in guild 1328126227013439601
2025-04-06 23:26:24 [DEBUG] bot.data.db_manager: Fetching one DB query: 
                    SELECT command_channel_1, command_channel_2, embed_channel_1, embed_channel_2, authorized_role
                    FROM server_settings WHERE guild_id = %s
                 with params: (1328126227013439601,)
2025-04-06 23:26:24 [DEBUG] bot.data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:26:24 [WARNING] bot.services.bet_service: Could not convert DB value to int for guild 1328126227013439601: 'Cappers'
2025-04-06 23:26:24 [DEBUG] bot.services.bet_service: Channel Check: Current=1357136356022816798 (type: <class 'int'>), Allowed=[1344085704984100934, 1357136356022816798] (types: [<class 'int'>, <class 'int'>])
2025-04-06 23:26:24 [DEBUG] bot.services.bet_service: No authorized role configured for guild 1328126227013439601, allowing /bet command.
2025-04-06 23:26:24 [INFO] bot.services.bet_service: /bet initiated by 761388542965448767 in allowed channel 1357136356022816798 for guild 1328126227013439601.
2025-04-06 23:26:24 [DEBUG] utils.serial_utils: Generated bet serial: 202504070626699
2025-04-06 23:26:24 [DEBUG] bot.services.bet_service: BetWorkflowView initialized (Serial: 202504070626699) Embed Channels: 1328126391073505422, 1357136356022816798
2025-04-06 23:26:24 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070626699. State: League=None, Type=None, Path=None, Preview=False
2025-04-06 23:26:24 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-06 23:26:27 [INFO] bot.services.bet_service: League selected: nfl by 761388542965448767 (Serial: 202504070626699)
2025-04-06 23:26:27 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070626699. State: League=nfl, Type=None, Path=None, Preview=False
2025-04-06 23:26:27 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-06 23:26:29 [INFO] bot.services.bet_service: Bet Type selected: Straight by 761388542965448767 (Serial: 202504070626699)
2025-04-06 23:26:29 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070626699. State: League=nfl, Type=Straight, Path=None, Preview=False
2025-04-06 23:26:29 [DEBUG] bot.services.bet_service: View updated with 3 components.
2025-04-06 23:26:30 [INFO] bot.services.bet_service: Path chosen: Game Line by 761388542965448767 (Serial: 202504070626699)
2025-04-06 23:26:46 [INFO] bot.services.bet_service: Game Line Modal submitted by 761388542965448767 (Serial: 202504070626699): {'team': 'Steelers', 'opponent': 'benglas', 'line': 'ml', 'odds': '-110', 'path': 'Game Line'}
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Generating preview for bet serial 202504070626699
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for team: Steelers
2025-04-06 23:26:47 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Steelers -> steelers for league nfl
2025-04-06 23:26:47 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nfl:steelers
2025-04-06 23:26:47 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nfl_logos.csv
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Result from get_team_logo_url_from_csv (team): None
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Final team_logo_url after fallback check: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for opponent: benglas
2025-04-06 23:26:47 [DEBUG] bot.data.league.league_team_handler: Normalized team name: benglas -> benglas for league nfl
2025-04-06 23:26:47 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nfl:benglas
2025-04-06 23:26:47 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nfl_logos.csv
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Result from get_team_logo_url_from_csv (opponent): None
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Final opponent_logo_url after fallback check: None
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Attempting to set thumbnail URL: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Thumbnail set successfully.
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504070626699. State: League=nfl, Type=Straight, Path=Game Line, Preview=True
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Populating ChannelSelect for guild 1328126227013439601 with IDs: [1328126391073505422, 1357136356022816798]
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Added channel option: #ðŸ“–-play-book (1328126391073505422)
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Added channel option: #team-chat (1357136356022816798)
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: View updated with 5 components.
2025-04-06 23:26:47 [DEBUG] bot.services.bet_service: Preview shown/updated for bet serial 202504070626699
2025-04-06 23:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-06 23:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-06 23:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-06 23:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-06 23:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-06 23:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-06 23:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-06 23:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 6, 30, 0, 811164, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 6, 30, 0, 811164, tzinfo=datetime.timezone.utc))
2025-04-06 23:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-06 23:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-06 23:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-06 23:30:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-06 23:30:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-06 23:30:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:30:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-06 23:31:47 [INFO] bot.services.bet_service: Bet setup timed out for bet serial 202504070626699 (User: 761388542965448767)
2025-04-06 23:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-06 23:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-06 23:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-06 23:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-06 23:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-06 23:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-06 23:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-06 23:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 6, 35, 0, 857950, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 6, 35, 0, 857950, tzinfo=datetime.timezone.utc))
2025-04-06 23:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-06 23:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-06 23:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-06 23:35:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-06 23:35:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-06 23:35:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:35:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-06 23:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-06 23:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-06 23:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-06 23:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-06 23:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-06 23:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-06 23:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-06 23:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 6, 40, 0, 905563, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 6, 40, 0, 905563, tzinfo=datetime.timezone.utc))
2025-04-06 23:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-06 23:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-06 23:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-06 23:40:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-06 23:40:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-06 23:40:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:40:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-06 23:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-06 23:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-06 23:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-06 23:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-06 23:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-06 23:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-06 23:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-06 23:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 6, 45, 0, 952316, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 6, 45, 0, 952316, tzinfo=datetime.timezone.utc))
2025-04-06 23:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-06 23:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-06 23:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-06 23:45:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-06 23:45:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-06 23:45:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:45:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-06 23:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-06 23:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-06 23:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-06 23:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-06 23:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-06 23:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-06 23:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-06 23:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 6, 50, 0, 995437, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 6, 50, 0, 995437, tzinfo=datetime.timezone.utc))
2025-04-06 23:50:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:50:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-06 23:50:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-06 23:50:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-06 23:50:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-06 23:50:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-06 23:50:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:50:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-06 23:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-06 23:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-06 23:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-06 23:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-06 23:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-06 23:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-06 23:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-06 23:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-06 23:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 6, 55, 0, 41143, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 6, 55, 0, 41143, tzinfo=datetime.timezone.utc))
2025-04-06 23:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-06 23:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-06 23:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-06 23:55:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-06 23:55:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-06 23:55:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-06 23:55:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 0, 0, 85506, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 0, 0, 85506, tzinfo=datetime.timezone.utc))
2025-04-07 00:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:00:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:00:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:00:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:00:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 5, 0, 134114, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 5, 0, 134114, tzinfo=datetime.timezone.utc))
2025-04-07 00:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:05:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:05:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:05:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:05:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 10, 0, 231049, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 10, 0, 231049, tzinfo=datetime.timezone.utc))
2025-04-07 00:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:10:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:10:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:10:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:10:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 15, 0, 290689, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 15, 0, 290689, tzinfo=datetime.timezone.utc))
2025-04-07 00:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:15:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:15:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:15:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:15:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 20, 0, 335896, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 20, 0, 335896, tzinfo=datetime.timezone.utc))
2025-04-07 00:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:20:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:20:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:20:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:20:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 25, 0, 383163, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 25, 0, 383163, tzinfo=datetime.timezone.utc))
2025-04-07 00:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:25:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:25:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:25:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:25:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 30, 0, 430524, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 30, 0, 430524, tzinfo=datetime.timezone.utc))
2025-04-07 00:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:30:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:30:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:30:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:30:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 35, 0, 505256, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 35, 0, 505256, tzinfo=datetime.timezone.utc))
2025-04-07 00:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:35:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:35:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:35:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:35:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 40, 0, 549605, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 40, 0, 549605, tzinfo=datetime.timezone.utc))
2025-04-07 00:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:40:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:40:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:40:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:40:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 45, 0, 603638, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 45, 0, 603638, tzinfo=datetime.timezone.utc))
2025-04-07 00:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:45:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:45:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:45:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:45:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 50, 0, 655294, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 50, 0, 655294, tzinfo=datetime.timezone.utc))
2025-04-07 00:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:50:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:50:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:50:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:50:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 00:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 00:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 00:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 00:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 00:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 00:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 00:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 00:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 00:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 7, 55, 0, 700359, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 7, 55, 0, 700359, tzinfo=datetime.timezone.utc))
2025-04-07 00:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 00:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 00:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 00:55:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 00:55:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 00:55:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 00:55:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 0, 0, 745159, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 0, 0, 745159, tzinfo=datetime.timezone.utc))
2025-04-07 01:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:00:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:00:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:00:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:00:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 5, 0, 836407, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 5, 0, 836407, tzinfo=datetime.timezone.utc))
2025-04-07 01:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:05:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:05:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:05:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:05:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 10, 0, 888099, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 10, 0, 888099, tzinfo=datetime.timezone.utc))
2025-04-07 01:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:10:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:10:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:10:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:10:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 15, 0, 935089, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 15, 0, 935089, tzinfo=datetime.timezone.utc))
2025-04-07 01:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:15:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:15:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:15:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:15:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:16:52 [WARNING] bot.core: Bot disconnected.
2025-04-07 01:16:52 [INFO] bot.core: Bot resumed connection.
2025-04-07 01:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 20, 0, 986021, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 20, 0, 986021, tzinfo=datetime.timezone.utc))
2025-04-07 01:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:20:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:20:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:20:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:20:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:25:01 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:25:01 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:25:01 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:25:01 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:25:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:25:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:25:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:25:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:25:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:25:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 25, 1, 29226, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 25, 1, 29226, tzinfo=datetime.timezone.utc))
2025-04-07 01:25:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:25:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:25:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:25:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 01:25:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:25:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:25:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:25:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 30, 0, 77518, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 30, 0, 77518, tzinfo=datetime.timezone.utc))
2025-04-07 01:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:30:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:30:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:30:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:30:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 35, 0, 119860, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 35, 0, 119860, tzinfo=datetime.timezone.utc))
2025-04-07 01:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:35:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:35:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:35:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:35:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 40, 0, 163200, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 40, 0, 163200, tzinfo=datetime.timezone.utc))
2025-04-07 01:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:40:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:40:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:40:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:40:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 45, 0, 207453, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 45, 0, 207453, tzinfo=datetime.timezone.utc))
2025-04-07 01:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:45:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:45:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:45:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:45:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 50, 0, 324092, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 50, 0, 324092, tzinfo=datetime.timezone.utc))
2025-04-07 01:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:50:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:50:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:50:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:50:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 01:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 01:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 01:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 01:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 01:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 01:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 01:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 01:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 01:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 8, 55, 0, 390051, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 8, 55, 0, 390051, tzinfo=datetime.timezone.utc))
2025-04-07 01:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 01:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 01:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 01:55:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 01:55:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 01:55:25 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 01:55:25 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 0, 0, 435294, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 0, 0, 435294, tzinfo=datetime.timezone.utc))
2025-04-07 02:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:00:25 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:00:25 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:00:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:00:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 5, 0, 509488, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 5, 0, 509488, tzinfo=datetime.timezone.utc))
2025-04-07 02:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:05:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:05:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:05:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:05:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 10, 0, 561738, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 10, 0, 561738, tzinfo=datetime.timezone.utc))
2025-04-07 02:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:10:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:10:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:10:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:10:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 15, 0, 611959, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 15, 0, 611959, tzinfo=datetime.timezone.utc))
2025-04-07 02:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:15:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:15:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:15:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:15:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 20, 0, 729588, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 20, 0, 729588, tzinfo=datetime.timezone.utc))
2025-04-07 02:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:20:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:20:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:20:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:20:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 25, 0, 782855, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 25, 0, 782855, tzinfo=datetime.timezone.utc))
2025-04-07 02:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:25:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:25:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:25:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:25:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 30, 0, 829125, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 30, 0, 829125, tzinfo=datetime.timezone.utc))
2025-04-07 02:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:30:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:30:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:30:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:30:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 35, 0, 885375, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 35, 0, 885375, tzinfo=datetime.timezone.utc))
2025-04-07 02:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:35:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:35:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:35:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:35:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 40, 0, 931419, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 40, 0, 931419, tzinfo=datetime.timezone.utc))
2025-04-07 02:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:40:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:40:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:40:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:40:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:45:01 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:45:01 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:45:01 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:45:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:45:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:45:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:45:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:45:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:45:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 45, 1, 112875, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 45, 1, 112875, tzinfo=datetime.timezone.utc))
2025-04-07 02:45:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:45:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:45:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:45:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 02:45:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:45:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:45:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:45:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 50, 0, 162424, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 50, 0, 162424, tzinfo=datetime.timezone.utc))
2025-04-07 02:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:50:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:50:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:50:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:50:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 02:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 02:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 02:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 02:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 02:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 02:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 02:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 02:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 02:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 9, 55, 0, 320145, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 9, 55, 0, 320145, tzinfo=datetime.timezone.utc))
2025-04-07 02:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 02:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 02:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 02:55:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 02:55:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 02:55:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 02:55:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 0, 0, 836326, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 0, 0, 836326, tzinfo=datetime.timezone.utc))
2025-04-07 03:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:00:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:00:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:00:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:00:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:05:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:05:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:05:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 5, 1, 84846, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 5, 1, 84846, tzinfo=datetime.timezone.utc))
2025-04-07 03:05:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:05:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:05:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:05:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 03:05:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:05:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:05:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:05:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 10, 0, 249085, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 10, 0, 249085, tzinfo=datetime.timezone.utc))
2025-04-07 03:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:10:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:10:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:10:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:10:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 15, 0, 311920, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 15, 0, 311920, tzinfo=datetime.timezone.utc))
2025-04-07 03:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:15:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:15:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:15:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:15:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 20, 0, 413716, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 20, 0, 413716, tzinfo=datetime.timezone.utc))
2025-04-07 03:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:20:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:20:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:20:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:20:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 25, 0, 488989, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 25, 0, 488989, tzinfo=datetime.timezone.utc))
2025-04-07 03:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:25:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:25:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:25:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:25:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:30:02 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:30:02 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:30:02 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:30:02 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:30:02 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:30:02 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:30:02 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:30:02 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:30:02 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 30, 2, 219647, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 30, 2, 219647, tzinfo=datetime.timezone.utc))
2025-04-07 03:30:02 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:30:02 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:30:02 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:30:02 [DEBUG] bot.services.voice_service: Voice service sleeping for 298.00 seconds until next 5-min mark.
2025-04-07 03:30:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:30:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:30:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:30:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 35, 0, 262539, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 35, 0, 262539, tzinfo=datetime.timezone.utc))
2025-04-07 03:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:35:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:35:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:35:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:35:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 40, 0, 317450, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 40, 0, 317450, tzinfo=datetime.timezone.utc))
2025-04-07 03:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:40:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:40:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:40:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:40:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 45, 0, 403884, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 45, 0, 403884, tzinfo=datetime.timezone.utc))
2025-04-07 03:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:45:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:45:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:45:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:45:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 50, 0, 457886, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 50, 0, 457886, tzinfo=datetime.timezone.utc))
2025-04-07 03:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:50:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:50:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:50:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:50:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 03:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 03:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 03:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 03:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 03:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 03:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 03:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 03:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 03:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 10, 55, 0, 506069, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 10, 55, 0, 506069, tzinfo=datetime.timezone.utc))
2025-04-07 03:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 03:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 03:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 03:55:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 03:55:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 03:55:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 03:55:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 0, 0, 554874, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 0, 0, 554874, tzinfo=datetime.timezone.utc))
2025-04-07 04:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:00:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:00:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:00:26 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:00:26 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 5, 0, 602857, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 5, 0, 602857, tzinfo=datetime.timezone.utc))
2025-04-07 04:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:05:26 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:05:26 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:05:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:05:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 10, 0, 759869, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 10, 0, 759869, tzinfo=datetime.timezone.utc))
2025-04-07 04:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:10:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:10:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:10:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:10:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 15, 0, 933277, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 15, 0, 933277, tzinfo=datetime.timezone.utc))
2025-04-07 04:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:15:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:15:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:15:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:15:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:20:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:20:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:20:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:20:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:20:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 20, 1, 37885, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 20, 1, 37885, tzinfo=datetime.timezone.utc))
2025-04-07 04:20:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:20:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:20:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:20:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 04:20:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:20:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:20:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:20:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 25, 0, 88251, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 25, 0, 88251, tzinfo=datetime.timezone.utc))
2025-04-07 04:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:25:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:25:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:25:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:25:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 30, 0, 135799, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 30, 0, 135799, tzinfo=datetime.timezone.utc))
2025-04-07 04:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:30:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:30:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:30:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:30:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 35, 0, 204181, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 35, 0, 204181, tzinfo=datetime.timezone.utc))
2025-04-07 04:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:35:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:35:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:35:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:35:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 40, 0, 263056, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 40, 0, 263056, tzinfo=datetime.timezone.utc))
2025-04-07 04:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:40:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:40:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:40:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:40:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 45, 0, 387797, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 45, 0, 387797, tzinfo=datetime.timezone.utc))
2025-04-07 04:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:45:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:45:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:45:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:45:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 50, 0, 478537, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 50, 0, 478537, tzinfo=datetime.timezone.utc))
2025-04-07 04:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:50:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:50:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:50:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:50:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 04:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 04:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 04:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 04:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 04:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 04:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 04:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 04:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 04:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 11, 55, 0, 552143, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 11, 55, 0, 552143, tzinfo=datetime.timezone.utc))
2025-04-07 04:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 04:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 04:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 04:55:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 04:55:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 04:55:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 04:55:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:00:01 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:00:01 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:00:01 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:00:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:00:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:00:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:00:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:00:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:00:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 0, 1, 266690, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 0, 1, 266690, tzinfo=datetime.timezone.utc))
2025-04-07 05:00:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:00:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:00:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:00:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 05:00:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:00:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:00:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:00:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 5, 0, 392508, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 5, 0, 392508, tzinfo=datetime.timezone.utc))
2025-04-07 05:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 05:05:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:05:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:05:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:05:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 10, 0, 948401, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 10, 0, 948401, tzinfo=datetime.timezone.utc))
2025-04-07 05:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 05:10:26 [WARNING] bot.core: Bot disconnected.
2025-04-07 05:10:27 [INFO] bot.core: Bot resumed connection.
2025-04-07 05:10:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:10:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:10:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:10:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:15:01 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:15:01 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:15:01 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:15:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:15:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:15:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:15:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:15:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:15:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 15, 1, 336854, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 15, 1, 336854, tzinfo=datetime.timezone.utc))
2025-04-07 05:15:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:15:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:15:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:15:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 05:15:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:15:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:15:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:15:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:20:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:20:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 20, 1, 30564, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 20, 1, 30564, tzinfo=datetime.timezone.utc))
2025-04-07 05:20:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:20:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:20:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:20:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 05:20:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:20:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:20:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:20:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 25, 0, 206141, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 25, 0, 206141, tzinfo=datetime.timezone.utc))
2025-04-07 05:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 05:25:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:25:27 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:25:27 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:25:27 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 30, 0, 264944, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 30, 0, 264944, tzinfo=datetime.timezone.utc))
2025-04-07 05:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 05:30:27 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:30:28 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:30:28 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:30:28 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:35:02 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:35:02 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:35:02 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:35:02 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:35:02 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:35:02 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:35:02 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:35:02 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:35:02 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 35, 2, 836696, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 35, 2, 836696, tzinfo=datetime.timezone.utc))
2025-04-07 05:35:02 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:35:02 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:35:02 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:35:02 [DEBUG] bot.services.voice_service: Voice service sleeping for 298.00 seconds until next 5-min mark.
2025-04-07 05:35:28 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:35:28 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:35:28 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:35:28 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 40, 0, 967413, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 40, 0, 967413, tzinfo=datetime.timezone.utc))
2025-04-07 05:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 05:40:28 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:40:28 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:40:28 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:40:28 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:45:01 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:45:01 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:45:01 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:45:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:45:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:45:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:45:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:45:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:45:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 45, 1, 46109, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 45, 1, 46109, tzinfo=datetime.timezone.utc))
2025-04-07 05:45:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:45:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:45:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:45:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 05:45:28 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:45:28 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:45:28 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:45:28 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:46:25 [DEBUG] bot.services.bet_service: /bet invoked in channel ID: 1344085704984100934 by user 821794684497690695 in guild 1328126227013439601
2025-04-07 05:46:26 [DEBUG] bot.data.db_manager: Fetching one DB query: 
                    SELECT command_channel_1, command_channel_2, embed_channel_1, embed_channel_2, authorized_role
                    FROM server_settings WHERE guild_id = %s
                 with params: (1328126227013439601,)
2025-04-07 05:46:26 [DEBUG] bot.data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:46:26 [WARNING] bot.services.bet_service: Could not convert DB value to int for guild 1328126227013439601: 'Cappers'
2025-04-07 05:46:26 [DEBUG] bot.services.bet_service: Channel Check: Current=1344085704984100934 (type: <class 'int'>), Allowed=[1344085704984100934, 1357136356022816798] (types: [<class 'int'>, <class 'int'>])
2025-04-07 05:46:26 [DEBUG] bot.services.bet_service: No authorized role configured for guild 1328126227013439601, allowing /bet command.
2025-04-07 05:46:26 [INFO] bot.services.bet_service: /bet initiated by 821794684497690695 in allowed channel 1344085704984100934 for guild 1328126227013439601.
2025-04-07 05:46:26 [DEBUG] utils.serial_utils: Generated bet serial: 202504071246211
2025-04-07 05:46:26 [DEBUG] bot.services.bet_service: BetWorkflowView initialized (Serial: 202504071246211) Embed Channels: 1328126391073505422, 1357136356022816798
2025-04-07 05:46:26 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071246211. State: League=None, Type=None, Path=None, Preview=False
2025-04-07 05:46:26 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-07 05:47:24 [INFO] bot.services.bet_service: League selected: nba by 821794684497690695 (Serial: 202504071246211)
2025-04-07 05:47:24 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071246211. State: League=nba, Type=None, Path=None, Preview=False
2025-04-07 05:47:24 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-07 05:47:33 [INFO] bot.services.bet_service: Bet Type selected: Straight by 821794684497690695 (Serial: 202504071246211)
2025-04-07 05:47:33 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071246211. State: League=nba, Type=Straight, Path=None, Preview=False
2025-04-07 05:47:33 [DEBUG] bot.services.bet_service: View updated with 3 components.
2025-04-07 05:47:43 [INFO] bot.services.bet_service: Path chosen: Player Prop by 821794684497690695 (Serial: 202504071246211)
2025-04-07 05:49:14 [INFO] bot.services.bet_service: Player Prop Modal submitted by 821794684497690695 (Serial: 202504071246211): {'team': 'Celtics', 'opponent': 'Lakers', 'player_name': 'Derrick White', 'prop': 'Over 2.5 3PM', 'odds': '-110', 'path': 'Player Prop'}
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Generating preview for bet serial 202504071246211
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for team: Celtics
2025-04-07 05:49:15 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Celtics -> celtics for league nba
2025-04-07 05:49:15 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:celtics
2025-04-07 05:49:15 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Result from get_team_logo_url_from_csv (team): None
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Final team_logo_url after fallback check: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Attempting to set thumbnail URL: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Thumbnail set successfully.
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071246211. State: League=nba, Type=Straight, Path=Player Prop, Preview=True
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Populating ChannelSelect for guild 1328126227013439601 with IDs: [1328126391073505422, 1357136356022816798]
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Added channel option: #ðŸ“–-play-book (1328126391073505422)
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Added channel option: #team-chat (1357136356022816798)
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: View updated with 5 components.
2025-04-07 05:49:15 [DEBUG] bot.services.bet_service: Preview shown/updated for bet serial 202504071246211
2025-04-07 05:49:30 [DEBUG] bot.services.bet_service: ChannelSelect callback triggered. Selected value: 1328126391073505422
2025-04-07 05:49:30 [INFO] bot.services.bet_service: Channel selected: 1328126391073505422 by 821794684497690695 (Serial: 202504071246211)
2025-04-07 05:49:30 [DEBUG] bot.services.bet_service: Updating preview description/footer. Channel: 1328126391073505422, Units: None
2025-04-07 05:49:30 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Celtics -> celtics for league nba
2025-04-07 05:49:30 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:celtics
2025-04-07 05:49:30 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:49:30 [DEBUG] bot.services.bet_service: Confirm button disabled state updated: True
2025-04-07 05:49:30 [DEBUG] bot.services.bet_service: Preview description/footer updated successfully.
2025-04-07 05:49:32 [INFO] bot.services.bet_service: Units selected: 1 by 821794684497690695 (Serial: 202504071246211)
2025-04-07 05:49:32 [DEBUG] bot.services.bet_service: Updating preview description/footer. Channel: 1328126391073505422, Units: 1
2025-04-07 05:49:32 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Celtics -> celtics for league nba
2025-04-07 05:49:32 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:celtics
2025-04-07 05:49:32 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:49:32 [DEBUG] bot.services.bet_service: Confirm button disabled state updated: False
2025-04-07 05:49:33 [DEBUG] bot.services.bet_service: Preview description/footer updated successfully.
2025-04-07 05:49:57 [INFO] bot.services.bet_service: Bet setup cancelled by 821794684497690695 for bet serial 202504071246211
2025-04-07 05:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 50, 0, 332916, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 50, 0, 332916, tzinfo=datetime.timezone.utc))
2025-04-07 05:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 05:50:28 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:50:28 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:50:28 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:50:28 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 05:52:23 [DEBUG] bot.services.bet_service: /bet invoked in channel ID: 1357136356022816798 by user 761388542965448767 in guild 1328126227013439601
2025-04-07 05:52:23 [DEBUG] bot.data.db_manager: Fetching one DB query: 
                    SELECT command_channel_1, command_channel_2, embed_channel_1, embed_channel_2, authorized_role
                    FROM server_settings WHERE guild_id = %s
                 with params: (1328126227013439601,)
2025-04-07 05:52:23 [DEBUG] bot.data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:52:23 [WARNING] bot.services.bet_service: Could not convert DB value to int for guild 1328126227013439601: 'Cappers'
2025-04-07 05:52:23 [DEBUG] bot.services.bet_service: Channel Check: Current=1357136356022816798 (type: <class 'int'>), Allowed=[1344085704984100934, 1357136356022816798] (types: [<class 'int'>, <class 'int'>])
2025-04-07 05:52:23 [DEBUG] bot.services.bet_service: No authorized role configured for guild 1328126227013439601, allowing /bet command.
2025-04-07 05:52:23 [INFO] bot.services.bet_service: /bet initiated by 761388542965448767 in allowed channel 1357136356022816798 for guild 1328126227013439601.
2025-04-07 05:52:23 [DEBUG] utils.serial_utils: Generated bet serial: 202504071252790
2025-04-07 05:52:23 [DEBUG] bot.services.bet_service: BetWorkflowView initialized (Serial: 202504071252790) Embed Channels: 1328126391073505422, 1357136356022816798
2025-04-07 05:52:23 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071252790. State: League=None, Type=None, Path=None, Preview=False
2025-04-07 05:52:23 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-07 05:52:28 [INFO] bot.services.bet_service: League selected: nba by 761388542965448767 (Serial: 202504071252790)
2025-04-07 05:52:28 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071252790. State: League=nba, Type=None, Path=None, Preview=False
2025-04-07 05:52:28 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-07 05:52:32 [INFO] bot.services.bet_service: Bet Type selected: Straight by 761388542965448767 (Serial: 202504071252790)
2025-04-07 05:52:32 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071252790. State: League=nba, Type=Straight, Path=None, Preview=False
2025-04-07 05:52:32 [DEBUG] bot.services.bet_service: View updated with 3 components.
2025-04-07 05:52:35 [INFO] bot.services.bet_service: Path chosen: Game Line by 761388542965448767 (Serial: 202504071252790)
2025-04-07 05:52:47 [INFO] bot.services.bet_service: Game Line Modal submitted by 761388542965448767 (Serial: 202504071252790): {'team': 'Lakers', 'opponent': 'Celtics', 'line': 'Ml', 'odds': '-110', 'path': 'Game Line'}
2025-04-07 05:52:47 [DEBUG] bot.services.bet_service: Generating preview for bet serial 202504071252790
2025-04-07 05:52:47 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for team: Lakers
2025-04-07 05:52:47 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Lakers -> lakers for league nba
2025-04-07 05:52:47 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:lakers
2025-04-07 05:52:48 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Result from get_team_logo_url_from_csv (team): None
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Final team_logo_url after fallback check: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for opponent: Celtics
2025-04-07 05:52:48 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Celtics -> celtics for league nba
2025-04-07 05:52:48 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:celtics
2025-04-07 05:52:48 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Result from get_team_logo_url_from_csv (opponent): None
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Final opponent_logo_url after fallback check: None
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Attempting to set thumbnail URL: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Thumbnail set successfully.
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504071252790. State: League=nba, Type=Straight, Path=Game Line, Preview=True
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Populating ChannelSelect for guild 1328126227013439601 with IDs: [1328126391073505422, 1357136356022816798]
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Added channel option: #ðŸ“–-play-book (1328126391073505422)
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Added channel option: #team-chat (1357136356022816798)
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: View updated with 5 components.
2025-04-07 05:52:48 [DEBUG] bot.services.bet_service: Preview shown/updated for bet serial 202504071252790
2025-04-07 05:52:54 [INFO] bot.services.bet_service: Units selected: 1 by 761388542965448767 (Serial: 202504071252790)
2025-04-07 05:52:55 [DEBUG] bot.services.bet_service: Updating preview description/footer. Channel: None, Units: 1
2025-04-07 05:52:55 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Lakers -> lakers for league nba
2025-04-07 05:52:55 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:lakers
2025-04-07 05:52:55 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:52:55 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Celtics -> celtics for league nba
2025-04-07 05:52:55 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:celtics
2025-04-07 05:52:55 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:52:55 [DEBUG] bot.services.bet_service: Confirm button disabled state updated: True
2025-04-07 05:52:55 [DEBUG] bot.services.bet_service: Preview description/footer updated successfully.
2025-04-07 05:53:01 [INFO] bot.services.bet_service: Units selected: 3 by 761388542965448767 (Serial: 202504071252790)
2025-04-07 05:53:01 [DEBUG] bot.services.bet_service: Updating preview description/footer. Channel: None, Units: 3
2025-04-07 05:53:01 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Lakers -> lakers for league nba
2025-04-07 05:53:01 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:lakers
2025-04-07 05:53:01 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:53:01 [DEBUG] bot.data.league.league_team_handler: Normalized team name: Celtics -> celtics for league nba
2025-04-07 05:53:01 [DEBUG] bot.data.cache_manager: Cache miss: team_logo_url_csv:nba:celtics
2025-04-07 05:53:01 [WARNING] utils.image_utils: Logo CSV not found: /home/container/bot/static/logos/nba_logos.csv
2025-04-07 05:53:01 [DEBUG] bot.services.bet_service: Confirm button disabled state updated: True
2025-04-07 05:53:02 [DEBUG] bot.services.bet_service: Preview description/footer updated successfully.
2025-04-07 05:53:08 [INFO] bot.services.bet_service: Bet setup cancelled by 761388542965448767 for bet serial 202504071252790
2025-04-07 05:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 05:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 05:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 05:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 05:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 05:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 05:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 05:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 05:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 12, 55, 0, 483238, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 12, 55, 0, 483238, tzinfo=datetime.timezone.utc))
2025-04-07 05:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 05:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 05:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 05:55:28 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 05:55:29 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 05:55:29 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 05:55:29 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 0, 0, 597204, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 0, 0, 597204, tzinfo=datetime.timezone.utc))
2025-04-07 06:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:00:29 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:00:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:00:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:00:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 5, 0, 954883, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 5, 0, 954883, tzinfo=datetime.timezone.utc))
2025-04-07 06:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:05:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:05:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:05:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:05:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:10:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:10:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:10:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:10:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:10:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:10:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 10, 1, 27802, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 10, 1, 27802, tzinfo=datetime.timezone.utc))
2025-04-07 06:10:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:10:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:10:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:10:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 06:10:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:10:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:10:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:10:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 15, 0, 104524, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 15, 0, 104524, tzinfo=datetime.timezone.utc))
2025-04-07 06:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:15:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:15:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:15:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:15:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 20, 0, 151773, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 20, 0, 151773, tzinfo=datetime.timezone.utc))
2025-04-07 06:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:20:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:20:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:20:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:20:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 25, 0, 199262, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 25, 0, 199262, tzinfo=datetime.timezone.utc))
2025-04-07 06:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:25:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:25:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:25:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:25:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 30, 0, 265591, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 30, 0, 265591, tzinfo=datetime.timezone.utc))
2025-04-07 06:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:30:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:30:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:30:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:30:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:34:42 [WARNING] bot.core: Bot disconnected.
2025-04-07 06:34:42 [INFO] bot.core: Bot resumed connection.
2025-04-07 06:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 35, 0, 320196, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 35, 0, 320196, tzinfo=datetime.timezone.utc))
2025-04-07 06:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:35:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:35:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:35:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:35:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 40, 0, 593401, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 40, 0, 593401, tzinfo=datetime.timezone.utc))
2025-04-07 06:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:40:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:40:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:40:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:40:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 06:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 06:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 06:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 06:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 06:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 06:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 06:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 06:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 06:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 13, 45, 0, 737212, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 13, 45, 0, 737212, tzinfo=datetime.timezone.utc))
2025-04-07 06:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 06:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 06:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 06:45:31 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 06:45:31 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 06:45:31 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 06:45:31 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
