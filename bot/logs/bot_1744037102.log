2025-04-07 07:45:01 [INFO] root: Logging configured successfully
2025-04-07 07:45:01 [DEBUG] asyncio: Using selector: EpollSelector
2025-04-07 07:45:01 [INFO] root: Logging configured successfully
2025-04-07 07:45:01 [INFO] __main__: Starting bot initialization
2025-04-07 07:45:01 [INFO] bot.data.db_manager: Attempting to connect to database s353073_bet_tracking_db at us.mysql.db.bot-hosting.net:3306
2025-04-07 07:45:02 [INFO] bot.data.db_manager: Database connection pool initialized successfully
2025-04-07 07:45:02 [DEBUG] bot.data.db_manager: Executing setup query 1...
2025-04-07 07:45:02 [DEBUG] bot.data.db_manager: Executing setup query 2...
2025-04-07 07:45:02 [DEBUG] bot.data.db_manager: Executing setup query 3...
2025-04-07 07:45:02 [DEBUG] bot.data.db_manager: Executing setup query 4...
2025-04-07 07:45:02 [INFO] bot.data.db_manager: Database tables checked/created successfully
2025-04-07 07:45:02 [INFO] __main__: Database connected successfully
2025-04-07 07:45:02 [DEBUG] __main__: Starting bot with Discord token (first 5 chars: MTM0M...)
2025-04-07 07:45:03 [INFO] bot.data.cache_manager: Attempting to connect to Redis at redis-14768.c246.us-east-1-4.ec2.redns.redis-cloud.com:14768
2025-04-07 07:45:03 [INFO] bot.data.cache_manager: Redis connection initialized successfully
2025-04-07 07:45:03 [INFO] api.sports_api: Sports API client session started
2025-04-07 07:45:03 [INFO] bot.services.game_service: Fetching initial game data for pending bets...
2025-04-07 07:45:03 [WARNING] data.db_manager: Database pool closed or not initialized. Attempting to reconnect.
2025-04-07 07:45:03 [INFO] data.db_manager: Attempting to connect to database s353073_bet_tracking_db at us.mysql.db.bot-hosting.net:3306
2025-04-07 07:45:03 [INFO] data.db_manager: Database connection pool initialized successfully
2025-04-07 07:45:03 [DEBUG] data.db_manager: Executing setup query 1...
2025-04-07 07:45:03 [DEBUG] data.db_manager: Executing setup query 2...
2025-04-07 07:45:03 [DEBUG] data.db_manager: Executing setup query 3...
2025-04-07 07:45:03 [DEBUG] data.db_manager: Executing setup query 4...
2025-04-07 07:45:04 [INFO] data.db_manager: Database tables checked/created successfully
2025-04-07 07:45:04 [DEBUG] data.db_manager: Fetching DB query: 
                SELECT DISTINCT event_id, league, team, opponent, game_start
                FROM bets
                WHERE event_id IS NOT NULL
                  AND bet_won IS NULL
                  AND bet_loss IS NULL
             with params: None
2025-04-07 07:45:04 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 07:45:04 [DEBUG] bot.services.game_service: Found 0 unique pending bet events to initialize.
2025-04-07 07:45:04 [WARNING] data.cache_manager: Redis client not initialized. Attempting connection.
2025-04-07 07:45:04 [INFO] data.cache_manager: Attempting to connect to Redis at redis-14768.c246.us-east-1-4.ec2.redns.redis-cloud.com:14768
2025-04-07 07:45:04 [INFO] data.cache_manager: Redis connection initialized successfully
2025-04-07 07:45:04 [DEBUG] data.cache_manager: Cache set: live_games (TTL: 600)
2025-04-07 07:45:04 [DEBUG] bot.services.game_service: Updated live games cache with 0 games.
2025-04-07 07:45:04 [INFO] bot.services.game_service: Initial game data fetching complete.
2025-04-07 07:45:04 [INFO] bot.services.game_service: Game service polling started.
2025-04-07 07:45:04 [INFO] bot.services.voice_service: Voice service update loop started.
2025-04-07 07:45:04 [INFO] web.server: Web application setup complete.
2025-04-07 07:45:04 [INFO] bot.core: Loading application commands...
2025-04-07 07:45:04 [INFO] bot.core: Loaded command: add_capper
2025-04-07 07:45:04 [INFO] bot.core: Loaded command: admin
2025-04-07 07:45:04 [INFO] bot.core: Loaded command: cancel_bet
2025-04-07 07:45:04 [INFO] bot.core: Loaded command: help
2025-04-07 07:45:04 [DEBUG] matplotlib: matplotlib data path: /home/container/.local/lib/python3.12/site-packages/matplotlib/mpl-data
2025-04-07 07:45:04 [DEBUG] matplotlib: CONFIGDIR=/home/container/.config/matplotlib
2025-04-07 07:45:04 [DEBUG] matplotlib: interactive is False
2025-04-07 07:45:04 [DEBUG] matplotlib: platform is linux
2025-04-07 07:45:05 [DEBUG] matplotlib: CACHEDIR=/home/container/.cache/matplotlib
2025-04-07 07:45:05 [DEBUG] matplotlib.font_manager: Using fontManager instance from /home/container/.cache/matplotlib/fontlist-v390.json
2025-04-07 07:45:06 [INFO] bot.core: Loaded command: leaderboard
2025-04-07 07:45:06 [INFO] bot.core: Loaded command: load_url
2025-04-07 07:45:06 [INFO] bot.core: Loaded command: profile
2025-04-07 07:45:06 [INFO] bot.core: Loaded command: setid
2025-04-07 07:45:06 [INFO] bot.core: Loaded command: show_cappers
2025-04-07 07:45:06 [INFO] bot.core: Loaded command: stats
2025-04-07 07:45:06 [INFO] bot.core: Loaded command: subscription
2025-04-07 07:45:06 [INFO] bot.core: Assuming 'bet' command is handled by BetService internally.
2025-04-07 07:45:06 [INFO] bot.core: Application commands loaded.
2025-04-07 07:45:06 [INFO] web.server: Web server started at http://0.0.0.0:20900/
2025-04-07 07:45:06 [INFO] bot.core: Commands synced to test guild ID: 1328126227013439601
2025-04-07 07:45:08 [INFO] bot.services.voice_service: Voice service entering update loop.
2025-04-07 07:45:08 [DEBUG] bot.services.voice_service: Voice service sleeping for 292.00 seconds until next 5-min mark.
2025-04-07 07:45:08 [INFO] bot.core: Logged in as Bet Embed Generator (ID: 1341993312915034153)
2025-04-07 07:45:08 [INFO] bot.core: Discord.py version: 2.3.2
2025-04-07 07:45:08 [INFO] bot.core: Bot is ready and online.
2025-04-07 07:45:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 07:45:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 07:45:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 07:45:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 07:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 07:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 07:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 07:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 07:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 07:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 07:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 07:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 07:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 07:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 14, 50, 0, 675620, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 14, 50, 0, 675620, tzinfo=datetime.timezone.utc))
2025-04-07 07:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 07:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 07:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 07:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 07:50:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 07:50:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 07:50:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 07:50:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 07:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 07:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 07:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 07:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 07:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 07:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 07:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 07:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 07:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 07:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 14, 55, 0, 724502, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 14, 55, 0, 724502, tzinfo=datetime.timezone.utc))
2025-04-07 07:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 07:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 07:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 07:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 07:55:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 07:55:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 07:55:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 07:55:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 0, 0, 772370, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 0, 0, 772370, tzinfo=datetime.timezone.utc))
2025-04-07 08:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:00:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:00:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:00:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:00:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 5, 0, 819823, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 5, 0, 819823, tzinfo=datetime.timezone.utc))
2025-04-07 08:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:05:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:05:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:05:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:05:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 10, 0, 869692, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 10, 0, 869692, tzinfo=datetime.timezone.utc))
2025-04-07 08:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:10:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:10:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:10:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:10:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 15, 0, 917940, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 15, 0, 917940, tzinfo=datetime.timezone.utc))
2025-04-07 08:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:15:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:15:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:15:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:15:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 20, 0, 968376, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 20, 0, 968376, tzinfo=datetime.timezone.utc))
2025-04-07 08:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:20:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:20:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:20:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:20:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:25:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:25:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:25:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 25, 1, 13966, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 25, 1, 13966, tzinfo=datetime.timezone.utc))
2025-04-07 08:25:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:25:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:25:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:25:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 08:25:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:25:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:25:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:25:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 30, 0, 62498, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 30, 0, 62498, tzinfo=datetime.timezone.utc))
2025-04-07 08:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:30:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:30:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:30:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:30:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:33:15 [WARNING] bot.core: Bot disconnected.
2025-04-07 08:33:15 [INFO] bot.core: Bot resumed connection.
2025-04-07 08:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 35, 0, 108621, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 35, 0, 108621, tzinfo=datetime.timezone.utc))
2025-04-07 08:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:35:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:35:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:35:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:35:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 40, 0, 152871, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 40, 0, 152871, tzinfo=datetime.timezone.utc))
2025-04-07 08:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:40:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:40:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:40:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:40:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 45, 0, 202449, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 45, 0, 202449, tzinfo=datetime.timezone.utc))
2025-04-07 08:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:45:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:45:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:45:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:45:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 50, 0, 249856, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 50, 0, 249856, tzinfo=datetime.timezone.utc))
2025-04-07 08:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:50:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:50:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:50:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:50:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 08:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 08:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 08:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 08:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 08:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 08:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 08:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 08:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 08:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 15, 55, 0, 295042, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 15, 55, 0, 295042, tzinfo=datetime.timezone.utc))
2025-04-07 08:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 08:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 08:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 08:55:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 08:55:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 08:55:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 08:55:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 0, 0, 410902, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 0, 0, 410902, tzinfo=datetime.timezone.utc))
2025-04-07 09:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:00:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:00:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:00:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:00:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 5, 0, 459581, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 5, 0, 459581, tzinfo=datetime.timezone.utc))
2025-04-07 09:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:05:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:05:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:05:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:05:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 10, 0, 506818, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 10, 0, 506818, tzinfo=datetime.timezone.utc))
2025-04-07 09:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:10:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:10:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:10:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:10:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 15, 0, 550742, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 15, 0, 550742, tzinfo=datetime.timezone.utc))
2025-04-07 09:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:15:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:15:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:15:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:15:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 20, 0, 595351, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 20, 0, 595351, tzinfo=datetime.timezone.utc))
2025-04-07 09:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:20:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:20:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:20:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:20:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 25, 0, 648555, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 25, 0, 648555, tzinfo=datetime.timezone.utc))
2025-04-07 09:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:25:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:25:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:25:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:25:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 30, 0, 693460, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 30, 0, 693460, tzinfo=datetime.timezone.utc))
2025-04-07 09:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:30:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:30:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:30:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:30:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:32:38 [WARNING] bot.core: Bot disconnected.
2025-04-07 09:32:38 [INFO] bot.core: Bot resumed connection.
2025-04-07 09:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 35, 0, 737327, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 35, 0, 737327, tzinfo=datetime.timezone.utc))
2025-04-07 09:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:35:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:35:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:35:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:35:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 40, 0, 802054, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 40, 0, 802054, tzinfo=datetime.timezone.utc))
2025-04-07 09:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:40:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:40:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:40:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:40:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 45, 0, 847755, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 45, 0, 847755, tzinfo=datetime.timezone.utc))
2025-04-07 09:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:45:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:45:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:45:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:45:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 50, 0, 892568, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 50, 0, 892568, tzinfo=datetime.timezone.utc))
2025-04-07 09:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:50:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:50:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:50:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:50:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 09:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 09:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 09:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 09:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 09:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 09:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 09:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 09:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 09:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 16, 55, 0, 936339, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 16, 55, 0, 936339, tzinfo=datetime.timezone.utc))
2025-04-07 09:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 09:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 09:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 09:55:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 09:55:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 09:55:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 09:55:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 0, 0, 982127, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 0, 0, 982127, tzinfo=datetime.timezone.utc))
2025-04-07 10:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:00:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:00:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:00:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:00:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:05:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:05:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:05:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:05:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:05:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:05:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 5, 1, 26102, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 5, 1, 26102, tzinfo=datetime.timezone.utc))
2025-04-07 10:05:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:05:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:05:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:05:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 10:05:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:05:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:05:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:05:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 10, 0, 74124, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 10, 0, 74124, tzinfo=datetime.timezone.utc))
2025-04-07 10:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:10:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:10:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:10:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:10:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 15, 0, 118169, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 15, 0, 118169, tzinfo=datetime.timezone.utc))
2025-04-07 10:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:15:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:15:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:15:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:15:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 20, 0, 162778, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 20, 0, 162778, tzinfo=datetime.timezone.utc))
2025-04-07 10:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:20:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:20:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:20:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:20:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 25, 0, 215606, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 25, 0, 215606, tzinfo=datetime.timezone.utc))
2025-04-07 10:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:25:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:25:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:25:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:25:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 30, 0, 262546, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 30, 0, 262546, tzinfo=datetime.timezone.utc))
2025-04-07 10:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:30:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:30:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:30:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:30:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 35, 0, 312606, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 35, 0, 312606, tzinfo=datetime.timezone.utc))
2025-04-07 10:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:35:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:35:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:35:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:35:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 40, 0, 356548, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 40, 0, 356548, tzinfo=datetime.timezone.utc))
2025-04-07 10:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:40:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:40:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:40:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:40:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 45, 0, 401161, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 45, 0, 401161, tzinfo=datetime.timezone.utc))
2025-04-07 10:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:45:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:45:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:45:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:45:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 50, 0, 453514, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 50, 0, 453514, tzinfo=datetime.timezone.utc))
2025-04-07 10:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:50:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:50:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:50:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:50:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 10:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 10:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 10:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 10:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 10:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 10:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 10:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 10:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 10:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 17, 55, 0, 500765, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 17, 55, 0, 500765, tzinfo=datetime.timezone.utc))
2025-04-07 10:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 10:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 10:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 10:55:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 10:55:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 10:55:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 10:55:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 0, 0, 548686, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 0, 0, 548686, tzinfo=datetime.timezone.utc))
2025-04-07 11:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:00:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:00:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:00:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:00:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 5, 0, 594103, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 5, 0, 594103, tzinfo=datetime.timezone.utc))
2025-04-07 11:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:05:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:05:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:05:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:05:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 10, 0, 646321, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 10, 0, 646321, tzinfo=datetime.timezone.utc))
2025-04-07 11:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:10:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:10:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:10:11 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:10:11 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 15, 0, 700344, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 15, 0, 700344, tzinfo=datetime.timezone.utc))
2025-04-07 11:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:15:11 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:15:11 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:15:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:15:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 20, 0, 742857, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 20, 0, 742857, tzinfo=datetime.timezone.utc))
2025-04-07 11:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:20:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:20:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:20:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:20:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:24:49 [WARNING] bot.core: Bot disconnected.
2025-04-07 11:24:49 [INFO] bot.core: Bot resumed connection.
2025-04-07 11:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 25, 0, 791442, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 25, 0, 791442, tzinfo=datetime.timezone.utc))
2025-04-07 11:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:25:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:25:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:25:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:25:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 30, 0, 837597, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 30, 0, 837597, tzinfo=datetime.timezone.utc))
2025-04-07 11:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:30:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:30:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:30:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:30:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 35, 0, 881481, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 35, 0, 881481, tzinfo=datetime.timezone.utc))
2025-04-07 11:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:35:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:35:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:35:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:35:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 40, 0, 925461, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 40, 0, 925461, tzinfo=datetime.timezone.utc))
2025-04-07 11:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:40:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:40:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:40:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:40:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:40:18 [WARNING] bot.core: Bot disconnected.
2025-04-07 11:40:18 [WARNING] bot.core: Bot disconnected.
2025-04-07 11:40:25 [INFO] bot.core: Logged in as Bet Embed Generator (ID: 1341993312915034153)
2025-04-07 11:40:25 [INFO] bot.core: Discord.py version: 2.3.2
2025-04-07 11:40:25 [INFO] bot.core: Bot is ready and online.
2025-04-07 11:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 45, 0, 979438, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 45, 0, 979438, tzinfo=datetime.timezone.utc))
2025-04-07 11:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:45:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:45:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:45:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:45:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:50:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:50:01 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:50:01 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:50:01 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:50:01 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:50:01 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 50, 1, 26313, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 50, 1, 26313, tzinfo=datetime.timezone.utc))
2025-04-07 11:50:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:50:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:50:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:50:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 11:50:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:50:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:50:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:50:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 11:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 11:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 11:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 11:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 11:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 11:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 11:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 11:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 11:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 18, 55, 0, 87166, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 18, 55, 0, 87166, tzinfo=datetime.timezone.utc))
2025-04-07 11:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 11:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 11:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 11:55:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 11:55:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 11:55:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 11:55:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 0, 0, 152293, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 0, 0, 152293, tzinfo=datetime.timezone.utc))
2025-04-07 12:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:00:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:00:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:00:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:00:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 5, 0, 204639, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 5, 0, 204639, tzinfo=datetime.timezone.utc))
2025-04-07 12:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:05:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:05:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:05:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:05:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 10, 0, 256687, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 10, 0, 256687, tzinfo=datetime.timezone.utc))
2025-04-07 12:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:10:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:10:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:10:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:10:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 15, 0, 300309, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 15, 0, 300309, tzinfo=datetime.timezone.utc))
2025-04-07 12:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:15:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:15:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:15:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:15:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 20, 0, 346621, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 20, 0, 346621, tzinfo=datetime.timezone.utc))
2025-04-07 12:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:20:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:20:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:20:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:20:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 25, 0, 390426, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 25, 0, 390426, tzinfo=datetime.timezone.utc))
2025-04-07 12:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:25:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:25:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:25:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:25:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 30, 0, 436292, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 30, 0, 436292, tzinfo=datetime.timezone.utc))
2025-04-07 12:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:30:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:30:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:30:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:30:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 35, 0, 482918, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 35, 0, 482918, tzinfo=datetime.timezone.utc))
2025-04-07 12:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:35:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:35:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:35:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:35:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 40, 0, 530084, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 40, 0, 530084, tzinfo=datetime.timezone.utc))
2025-04-07 12:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:40:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:40:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:40:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:40:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 45, 0, 575162, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 45, 0, 575162, tzinfo=datetime.timezone.utc))
2025-04-07 12:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:45:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:45:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:45:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:45:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 50, 0, 626837, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 50, 0, 626837, tzinfo=datetime.timezone.utc))
2025-04-07 12:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:50:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:50:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:50:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:50:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 12:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 12:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 12:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 12:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 12:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 12:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 12:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 12:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 19, 55, 0, 670489, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 19, 55, 0, 670489, tzinfo=datetime.timezone.utc))
2025-04-07 12:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 12:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 12:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 12:55:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 12:55:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 12:55:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 12:55:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 12:59:36 [WARNING] bot.core: Bot disconnected.
2025-04-07 12:59:36 [INFO] bot.core: Bot resumed connection.
2025-04-07 13:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 0, 0, 713918, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 0, 0, 713918, tzinfo=datetime.timezone.utc))
2025-04-07 13:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:00:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:00:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:00:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:00:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 5, 0, 758480, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 5, 0, 758480, tzinfo=datetime.timezone.utc))
2025-04-07 13:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:05:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:05:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:05:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:05:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 10, 0, 803561, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 10, 0, 803561, tzinfo=datetime.timezone.utc))
2025-04-07 13:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:10:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:10:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:10:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:10:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 15, 0, 850564, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 15, 0, 850564, tzinfo=datetime.timezone.utc))
2025-04-07 13:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:15:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:15:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:15:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:15:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 20, 0, 899090, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 20, 0, 899090, tzinfo=datetime.timezone.utc))
2025-04-07 13:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:20:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:20:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:20:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:20:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 25, 0, 951590, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 25, 0, 951590, tzinfo=datetime.timezone.utc))
2025-04-07 13:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:25:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:25:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:25:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:25:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 30, 0, 995854, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 30, 0, 995854, tzinfo=datetime.timezone.utc))
2025-04-07 13:30:01 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:30:01 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:30:01 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:30:01 [DEBUG] bot.services.voice_service: Voice service sleeping for 299.00 seconds until next 5-min mark.
2025-04-07 13:30:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:30:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:30:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:30:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 35, 0, 45975, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 35, 0, 45975, tzinfo=datetime.timezone.utc))
2025-04-07 13:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:35:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:35:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:35:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:35:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 40, 0, 90023, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 40, 0, 90023, tzinfo=datetime.timezone.utc))
2025-04-07 13:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:40:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:40:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:40:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:40:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 45, 0, 133452, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 45, 0, 133452, tzinfo=datetime.timezone.utc))
2025-04-07 13:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:45:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:45:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:45:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:45:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 50, 0, 180959, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 50, 0, 180959, tzinfo=datetime.timezone.utc))
2025-04-07 13:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:50:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:50:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:50:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:50:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 13:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 13:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 13:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 13:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 13:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 13:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 13:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 13:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 20, 55, 0, 230290, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 20, 55, 0, 230290, tzinfo=datetime.timezone.utc))
2025-04-07 13:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 13:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 13:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 13:55:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 13:55:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 13:55:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 13:55:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 13:57:05 [WARNING] bot.core: Bot disconnected.
2025-04-07 13:57:05 [INFO] bot.core: Bot resumed connection.
2025-04-07 14:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 0, 0, 278466, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 0, 0, 278466, tzinfo=datetime.timezone.utc))
2025-04-07 14:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:00:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:00:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:00:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:00:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:05:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:05:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:05:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:05:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:05:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:05:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:05:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:05:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:05:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 5, 0, 325036, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 5, 0, 325036, tzinfo=datetime.timezone.utc))
2025-04-07 14:05:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:05:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:05:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:05:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:05:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:05:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:05:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:05:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:10:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:10:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:10:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:10:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:10:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:10:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:10:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:10:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:10:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 10, 0, 379484, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 10, 0, 379484, tzinfo=datetime.timezone.utc))
2025-04-07 14:10:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:10:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:10:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:10:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:10:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:10:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:10:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:10:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:15:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:15:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:15:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:15:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:15:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:15:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:15:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:15:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:15:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 15, 0, 423706, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 15, 0, 423706, tzinfo=datetime.timezone.utc))
2025-04-07 14:15:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:15:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:15:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:15:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:15:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:15:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:15:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:15:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:20:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:20:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:20:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:20:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:20:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:20:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:20:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:20:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:20:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 20, 0, 472332, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 20, 0, 472332, tzinfo=datetime.timezone.utc))
2025-04-07 14:20:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:20:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:20:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:20:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:20:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:20:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:20:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:20:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:25:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:25:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:25:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:25:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:25:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:25:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:25:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:25:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:25:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 25, 0, 519016, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 25, 0, 519016, tzinfo=datetime.timezone.utc))
2025-04-07 14:25:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:25:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:25:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:25:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:25:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:25:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:25:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:25:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:30:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:30:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:30:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:30:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:30:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:30:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:30:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:30:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:30:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 30, 0, 570437, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 30, 0, 570437, tzinfo=datetime.timezone.utc))
2025-04-07 14:30:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:30:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:30:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:30:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:30:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:30:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:30:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:30:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:35:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:35:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:35:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:35:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:35:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:35:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:35:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:35:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:35:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 35, 0, 615746, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 35, 0, 615746, tzinfo=datetime.timezone.utc))
2025-04-07 14:35:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:35:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:35:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:35:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:35:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:35:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:35:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:35:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:40:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:40:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:40:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:40:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:40:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:40:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:40:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:40:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:40:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 40, 0, 664316, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 40, 0, 664316, tzinfo=datetime.timezone.utc))
2025-04-07 14:40:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:40:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:40:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:40:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:40:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:40:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:40:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:40:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:45:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:45:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:45:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:45:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:45:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:45:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:45:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:45:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:45:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 45, 0, 706764, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 45, 0, 706764, tzinfo=datetime.timezone.utc))
2025-04-07 14:45:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:45:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:45:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:45:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:45:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:45:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:45:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:45:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:50:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:50:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:50:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:50:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:50:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:50:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:50:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:50:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:50:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 50, 0, 756600, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 50, 0, 756600, tzinfo=datetime.timezone.utc))
2025-04-07 14:50:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:50:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:50:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:50:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:50:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:50:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:50:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:50:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:55:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 14:55:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 14:55:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 14:55:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 14:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:55:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 14:55:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 14:55:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:55:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 14:55:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 21, 55, 0, 801098, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 21, 55, 0, 801098, tzinfo=datetime.timezone.utc))
2025-04-07 14:55:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:55:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 14:55:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 14:55:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 14:55:10 [DEBUG] bot.services.bet_service: /bet invoked in channel ID: 1357136356022816798 by user 761388542965448767 in guild 1328126227013439601
2025-04-07 14:55:11 [DEBUG] bot.data.db_manager: Fetching one DB query: 
                    SELECT command_channel_1, command_channel_2, embed_channel_1, embed_channel_2, authorized_role
                    FROM server_settings WHERE guild_id = %s
                 with params: (1328126227013439601,)
2025-04-07 14:55:11 [DEBUG] bot.data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 14:55:11 [WARNING] bot.services.bet_service: Could not convert DB value to int for guild 1328126227013439601: 'Cappers'
2025-04-07 14:55:11 [DEBUG] bot.services.bet_service: Channel Check: Current=1357136356022816798 (type: <class 'int'>), Allowed=[1344085704984100934, 1357136356022816798] (types: [<class 'int'>, <class 'int'>])
2025-04-07 14:55:11 [DEBUG] bot.services.bet_service: No authorized role configured for guild 1328126227013439601, allowing /bet command.
2025-04-07 14:55:11 [INFO] bot.services.bet_service: /bet initiated by 761388542965448767 in allowed channel 1357136356022816798 for guild 1328126227013439601.
2025-04-07 14:55:11 [DEBUG] utils.serial_utils: Generated bet serial: 202504072155382
2025-04-07 14:55:11 [DEBUG] bot.services.bet_service: BetWorkflowView initialized (Serial: 202504072155382) Embed Channels: 1328126391073505422, 1357136356022816798
2025-04-07 14:55:11 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504072155382. State: League=None, Type=None, Path=None, Preview=False
2025-04-07 14:55:11 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-07 14:55:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 14:55:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 14:55:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 14:55:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
2025-04-07 14:55:14 [INFO] bot.services.bet_service: League selected: nfl by 761388542965448767 (Serial: 202504072155382)
2025-04-07 14:55:14 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504072155382. State: League=nfl, Type=None, Path=None, Preview=False
2025-04-07 14:55:14 [DEBUG] bot.services.bet_service: View updated with 2 components.
2025-04-07 14:55:17 [INFO] bot.services.bet_service: Bet Type selected: Straight by 761388542965448767 (Serial: 202504072155382)
2025-04-07 14:55:17 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504072155382. State: League=nfl, Type=Straight, Path=None, Preview=False
2025-04-07 14:55:17 [DEBUG] bot.services.bet_service: View updated with 3 components.
2025-04-07 14:55:19 [INFO] bot.services.bet_service: Path chosen: Player Prop by 761388542965448767 (Serial: 202504072155382)
2025-04-07 14:57:54 [INFO] bot.services.bet_service: Player Prop Modal submitted by 761388542965448767 (Serial: 202504072155382): {'team': 'Bengals', 'opponent': 'Colts', 'player_name': 'Player Name', 'prop': "Over 2 TD's", 'odds': '+300', 'path': 'Player Prop'}
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Generating preview for bet serial 202504072155382
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Calling get_team_logo_url_from_csv for team: Bengals
2025-04-07 14:57:54 [ERROR] bot.services.bet_service: Error fetching team logo URL for Bengals: attempted relative import beyond top-level package
Traceback (most recent call last):
  File "/home/container/bot/services/bet_service.py", line 169, in show_preview
    fetched_team_logo = await get_team_logo_url_from_csv(self.selected_league, team_name)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/container/bot/utils/image_utils.py", line 160, in get_team_logo_url_from_csv
    from ..data.league.league_team_handler import normalize_team_name
ImportError: attempted relative import beyond top-level package
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Attempting to set thumbnail URL: https://cdn.discordapp.com/embed/avatars/0.png
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Thumbnail set successfully.
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Updating view state for bet serial 202504072155382. State: League=nfl, Type=Straight, Path=Player Prop, Preview=True
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Populating ChannelSelect for guild 1328126227013439601 with IDs: [1328126391073505422, 1357136356022816798]
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Added channel option: #📖-play-book (1328126391073505422)
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Added channel option: #team-chat (1357136356022816798)
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: View updated with 5 components.
2025-04-07 14:57:54 [DEBUG] bot.services.bet_service: Preview shown/updated for bet serial 202504072155382
2025-04-07 14:58:03 [INFO] bot.services.bet_service: Units selected: 2 by 761388542965448767 (Serial: 202504072155382)
2025-04-07 14:58:03 [DEBUG] bot.services.bet_service: Updating preview description/footer. Channel: None, Units: 2
2025-04-07 14:58:03 [WARNING] bot.services.bet_service: Error fetching logo URLs during update: attempted relative import beyond top-level package
2025-04-07 14:58:03 [DEBUG] bot.services.bet_service: Confirm button disabled state updated: True
2025-04-07 14:58:04 [DEBUG] bot.services.bet_service: Preview description/footer updated successfully.
2025-04-07 14:58:06 [INFO] bot.services.bet_service: Bet setup cancelled by 761388542965448767 for bet serial 202504072155382
2025-04-07 15:00:00 [INFO] bot.services.voice_service: Voice service starting synchronized update cycle.
2025-04-07 15:00:00 [DEBUG] bot.services.voice_service: Updating voice channels for guild: Cookin' Books (1328126227013439601)
2025-04-07 15:00:00 [DEBUG] bot.services.voice_service: Skipping unit reset logic for guild 1328126227013439601 due to schema incompatibility.
2025-04-07 15:00:00 [DEBUG] data.db_manager: Fetching one DB query: SELECT voice_channel_id FROM server_settings WHERE guild_id = %s with params: (1328126227013439601,)
2025-04-07 15:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 15:00:00 [DEBUG] bot.services.voice_service: Found Total Units channel 1357135914622779402 for guild 1328126227013439601
2025-04-07 15:00:00 [DEBUG] data.db_manager: Fetching one DB query: 
            SELECT SUM(CASE WHEN bet_won = 1 THEN units ELSE 0 END) -
                   SUM(CASE WHEN bet_loss = 1 THEN units ELSE 0 END) as net_units
            FROM bets
            WHERE guild_id = %s AND (bet_won = 1 OR bet_loss = 1)
         with params: (1328126227013439601,)
2025-04-07 15:00:00 [DEBUG] data.db_manager: Query fetch_one successful. Result found: Yes
2025-04-07 15:00:00 [DEBUG] bot.services.voice_service: Calculated net units for guild 1328126227013439601: 46.0
2025-04-07 15:00:00 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT bet_serial, event_id, league, team, opponent, game_start
                    FROM bets
                    WHERE guild_id = %s
                      AND bet_won IS NULL
                      AND bet_loss IS NULL
                      AND game_start IS NOT NULL
                      AND game_start BETWEEN %s AND %s
                 with params: (1328126227013439601, datetime.datetime(2025, 4, 6, 22, 0, 0, 845964, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 4, 9, 22, 0, 0, 845964, tzinfo=datetime.timezone.utc))
2025-04-07 15:00:00 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 15:00:00 [DEBUG] bot.services.voice_service: Found 0 relevant pending bets for guild 1328126227013439601
2025-04-07 15:00:00 [INFO] bot.services.voice_service: Voice service update cycle finished.
2025-04-07 15:00:00 [DEBUG] bot.services.voice_service: Voice service sleeping for 300.00 seconds until next 5-min mark.
2025-04-07 15:00:12 [DEBUG] bot.services.game_service: Starting game polling cycle...
2025-04-07 15:00:12 [DEBUG] data.db_manager: Fetching DB query: 
                    SELECT DISTINCT league
                    FROM bets
                    WHERE bet_won IS NULL AND bet_loss IS NULL AND league IS NOT NULL
                 with params: None
2025-04-07 15:00:12 [DEBUG] data.db_manager: Query fetch successful. Row count: 0
2025-04-07 15:00:12 [INFO] bot.services.game_service: No active leagues with pending bets found. Skipping API poll.
